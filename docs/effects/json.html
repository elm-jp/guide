
<!DOCTYPE HTML>
<html lang="ja" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>JSON · An Introduction to Elm</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Evan Czaplicki">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="random.html" />
    
    
    <link rel="prev" href="http.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="検索すると入力" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../about_translation.html">
            
                <a href="../about_translation.html">
            
                    
                    翻訳について
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../">
            
                <a href="../">
            
                    
                    はじめに
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../install.html">
            
                <a href="../install.html">
            
                    
                    インストール
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../core_language.html">
            
                <a href="../core_language.html">
            
                    
                    言語の基礎
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../architecture/">
            
                <a href="../architecture/">
            
                    
                    The Elm Architecture
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../architecture/buttons.html">
            
                <a href="../architecture/buttons.html">
            
                    
                    ボタン
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../architecture/text_fields.html">
            
                <a href="../architecture/text_fields.html">
            
                    
                    テキストフィールド
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../architecture/forms.html">
            
                <a href="../architecture/forms.html">
            
                    
                    フォーム
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../types/">
            
                <a href="../types/">
            
                    
                    型
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../types/reading_types.html">
            
                <a href="../types/reading_types.html">
            
                    
                    型を読む
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../types/type_aliases.html">
            
                <a href="../types/type_aliases.html">
            
                    
                    型の別名
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../types/custom_types.html">
            
                <a href="../types/custom_types.html">
            
                    
                    カスタム型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../types/pattern_matching.html">
            
                <a href="../types/pattern_matching.html">
            
                    
                    パターンマッチ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../error_handling/">
            
                <a href="../error_handling/">
            
                    
                    Error Handling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../error_handling/maybe.html">
            
                <a href="../error_handling/maybe.html">
            
                    
                    Maybe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../error_handling/result.html">
            
                <a href="../error_handling/result.html">
            
                    
                    Result
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="./">
            
                <a href="./">
            
                    
                    コマンドとサブスクリプション
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="http.html">
            
                <a href="http.html">
            
                    
                    HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.8.2" data-path="json.html">
            
                <a href="json.html">
            
                    
                    JSON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="random.html">
            
                <a href="random.html">
            
                    
                    Random
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="time.html">
            
                <a href="time.html">
            
                    
                    Time
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../interop/">
            
                <a href="../interop/">
            
                    
                    JavaScriptとの相互運用
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../interop/flags.html">
            
                <a href="../interop/flags.html">
            
                    
                    フラグ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../interop/ports.html">
            
                <a href="../interop/ports.html">
            
                    
                    ポート
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../interop/custom_elements.html">
            
                <a href="../interop/custom_elements.html">
            
                    
                    カスタムエレメンツ
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../webapps/">
            
                <a href="../webapps/">
            
                    
                    Webアプリケーション
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../webapps/navigation.html">
            
                <a href="../webapps/navigation.html">
            
                    
                    ナビゲーションする
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../webapps/url_parsing.html">
            
                <a href="../webapps/url_parsing.html">
            
                    
                    URLをパースする
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../webapps/modules.html">
            
                <a href="../webapps/modules.html">
            
                    
                    モジュール
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../webapps/structure.html">
            
                <a href="../webapps/structure.html">
            
                    
                    モジュールの構造化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../optimization/">
            
                <a href="../optimization/">
            
                    
                    最適化
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../optimization/lazy.html">
            
                <a href="../optimization/lazy.html">
            
                    
                    Html.lazy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../optimization/keyed.html">
            
                <a href="../optimization/keyed.html">
            
                    
                    Html.keyed
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../optimization/asset_size.html">
            
                <a href="../optimization/asset_size.html">
            
                    
                    アセットサイズ縮小化
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../next_steps.html">
            
                <a href="../next_steps.html">
            
                    
                    次への一歩
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" >
            
                <span>
            
                    
                    付録
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../appendix/types_as_sets.html">
            
                <a href="../appendix/types_as_sets.html">
            
                    
                    集合としての型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../appendix/types_as_bits.html">
            
                <a href="../appendix/types_as_bits.html">
            
                    
                    型のビット表現
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../appendix/function_types.html">
            
                <a href="../appendix/function_types.html">
            
                    
                    関数の型
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            GitBookで公開 
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >JSON</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="json">JSON</h1>
<hr>
<h4 id="clone-the-code-or-follow-along-in-the-online-editor"><a href="https://github.com/evancz/elm-architecture-tutorial/" target="_blank">Clone the code</a> or follow along in the <a href="https://ellie-app.com/3SYSHFsJxTGa1" target="_blank">online editor</a>.</h4>
<hr>
<p>We just saw an example that uses HTTP to get the content of a book. That is great, but a ton of servers return data in a special format called JavaScript Object Notation, or JSON for short.</p>
<p>So our next example shows how to fetch some JSON data, allowing us to press a button to show random cat GIFs.</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Browser
<span class="hljs-keyword">import</span> Html <span class="hljs-keyword">exposing</span> (..)
<span class="hljs-keyword">import</span> Html.Attributes <span class="hljs-keyword">exposing</span> (..)
<span class="hljs-keyword">import</span> Html.Events <span class="hljs-keyword">exposing</span> (..)
<span class="hljs-keyword">import</span> Http
<span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, string)



<span class="hljs-comment">-- MAIN</span>


<span class="hljs-title">main</span> =
  <span class="hljs-type">Browser</span>.element
    { init = init
    , update = update
    , subscriptions = subscriptions
    , view = view
    }



<span class="hljs-comment">-- MODEL</span>


<span class="hljs-keyword">type</span> <span class="hljs-type">Model</span>
  = <span class="hljs-type">Failure</span>
  | <span class="hljs-type">Loading</span>
  | <span class="hljs-type">Success</span> <span class="hljs-type">String</span>


<span class="hljs-title">init</span> : () -&gt; (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">init</span> _ =
  (<span class="hljs-type">Loading</span>, getRandomCatGif)



<span class="hljs-comment">-- UPDATE</span>


<span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
  = <span class="hljs-type">MorePlease</span>
  | <span class="hljs-type">GotGif</span> (<span class="hljs-type">Result</span> <span class="hljs-type">Http</span>.<span class="hljs-type">Error</span> <span class="hljs-type">String</span>)


<span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; (<span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>)
<span class="hljs-title">update</span> msg model =
  <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
    <span class="hljs-type">MorePlease</span> -&gt;
      (<span class="hljs-type">Loading</span>, getRandomCatGif)

    <span class="hljs-type">GotGif</span> result -&gt;
      <span class="hljs-keyword">case</span> result <span class="hljs-keyword">of</span>
        <span class="hljs-type">Ok</span> url -&gt;
          (<span class="hljs-type">Success</span> url, <span class="hljs-type">Cmd</span>.none)

        <span class="hljs-type">Err</span> _ -&gt;
          (<span class="hljs-type">Failure</span>, <span class="hljs-type">Cmd</span>.none)



<span class="hljs-comment">-- SUBSCRIPTIONS</span>


<span class="hljs-title">subscriptions</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Sub</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">subscriptions</span> model =
  <span class="hljs-type">Sub</span>.none



<span class="hljs-comment">-- VIEW</span>


<span class="hljs-title">view</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">view</span> model =
  div []
    [ h2 [] [ text <span class="hljs-string">&quot;Random Cats&quot;</span> ]
    , viewGif model
    ]


<span class="hljs-title">viewGif</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">viewGif</span> model =
  <span class="hljs-keyword">case</span> model <span class="hljs-keyword">of</span>
    <span class="hljs-type">Failure</span> -&gt;
      div []
        [ text <span class="hljs-string">&quot;I could not load a random cat for some reason. &quot;</span>
        , button [ onClick <span class="hljs-type">MorePlease</span> ] [ text <span class="hljs-string">&quot;Try Again!&quot;</span> ]
        ]

    <span class="hljs-type">Loading</span> -&gt;
      text <span class="hljs-string">&quot;Loading...&quot;</span>

    <span class="hljs-type">Success</span> url -&gt;
      div []
        [ button [ onClick <span class="hljs-type">MorePlease</span>, style <span class="hljs-string">&quot;display&quot;</span> <span class="hljs-string">&quot;block&quot;</span> ] [ text <span class="hljs-string">&quot;More Please!&quot;</span> ]
        , img [ src url ] []
        ]



<span class="hljs-comment">-- HTTP</span>


<span class="hljs-title">getRandomCatGif</span> : <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">getRandomCatGif</span> =
  <span class="hljs-type">Http</span>.get
    { url = <span class="hljs-string">&quot;https://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC&amp;tag=cat&quot;</span>
    , expect = <span class="hljs-type">Http</span>.expectJson <span class="hljs-type">GotGif</span> gifDecoder
    }


<span class="hljs-title">gifDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">String</span>
<span class="hljs-title">gifDecoder</span> =
  field <span class="hljs-string">&quot;data&quot;</span> (field <span class="hljs-string">&quot;image_url&quot;</span> string)
</code></pre>
<p>This example is pretty similar to the last one:</p>
<ul>
<li><code>init</code> starts us off in the <code>Loading</code> state, with a command to get a random cat GIF.</li>
<li><code>update</code> handles the <code>GotGif</code> message for whenever a new GIF is available. Whatever happens there, we do not have any additional commands. It also handles the <code>MorePlease</code> message when someone presses the button, issuing a command to get more random cats.</li>
<li><code>view</code> shows you the cats!</li>
</ul>
<p>The main diferrence is in the <code>getRandomCatGif</code> definition. Instead of using <code>Http.expectString</code>, we have switched to <code>Http.expectJson</code>. What is the deal with that?</p>
<h2 id="json">JSON</h2>
<p>When you ask <a href="https://api.giphy.com/v1/gifs/random?api_key=dc6zaTOxFJmzC&amp;tag=cat" target="_blank"><code>api.giphy.com</code></a> for a random cat GIF, their server produces a big string of JSON like this:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;data&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;gif&quot;</span>,
    <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;l2JhxfHWMBWuDMIpi&quot;</span>,
    <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;cat love GIF by The Secret Life Of Pets&quot;</span>,
    <span class="hljs-string">&quot;image_url&quot;</span>: <span class="hljs-string">&quot;https://media1.giphy.com/media/l2JhxfHWMBWuDMIpi/giphy.gif&quot;</span>,
    <span class="hljs-string">&quot;caption&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,
    ...
  },
  <span class="hljs-string">&quot;meta&quot;</span>: {
    <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-number">200</span>,
    <span class="hljs-string">&quot;msg&quot;</span>: <span class="hljs-string">&quot;OK&quot;</span>,
    <span class="hljs-string">&quot;response_id&quot;</span>: <span class="hljs-string">&quot;5b105e44316d3571456c18b3&quot;</span>
  }
}
</code></pre>
<p>We have no guarantees about any of the information here. The server can change the names of fields, and the fields may have different types in different situations. It is a wild world!</p>
<p>In JavaScript, the approach is to just turn JSON into JavaScript objects and hope nothing goes wrong. But if there is some typo or unexpected data, you get a runtime exception somewhere in your code. Was the code wrong? Was the data wrong? It is time to start digging around to find out!</p>
<p>In Elm, we validate the JSON before it comes into our program. So if the data has an unexpected structure, we learn about it immediately. There is no way for bad data to sneak through and cause a runtime exception three files over. This is accomplished with JSON decoders.</p>
<h2 id="json-decoders">JSON Decoders</h2>
<p>Say we have some JSON:</p>
<pre><code class="lang-json">{
    <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;Tom&quot;</span>,
    <span class="hljs-string">&quot;age&quot;</span>: <span class="hljs-number">42</span>
}
</code></pre>
<p>We need to run it through a <code>Decoder</code> to access specific information. So if we wanted to get the <code>&quot;age&quot;</code>, we would run the JSON through a <code>Decoder Int</code> that describes exactly how to access that information:</p>
<p><img src="diagrams/int.svg" alt=""></p>
<p>If all goes well, we get an <code>Int</code> on the other side! And if we wanted the <code>&quot;name&quot;</code> we would run the JSON through a <code>Decoder String</code> that describes exactly how to access it:</p>
<p><img src="diagrams/string.svg" alt=""></p>
<p>If all goes well, we get a <code>String</code> on the other side!</p>
<p>How do we create decoders like this though?</p>
<h2 id="building-blocks">Building Blocks</h2>
<p>The <a href="https://package.elm-lang.org/packages/elm/json/latest/" target="_blank"><code>elm/json</code></a> package gives us the <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode" target="_blank"><code>Json.Decode</code></a> module. It is filled with tiny decoders that we can snap together.</p>
<p>So to get <code>&quot;age&quot;</code> from <code>{ &quot;name&quot;: &quot;Tom&quot;, &quot;age&quot;: 42 }</code> we would create a decoder like this:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, int)

<span class="hljs-title">ageDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">Int</span>
<span class="hljs-title">ageDecoder</span> =
  field <span class="hljs-string">&quot;age&quot;</span> int

 <span class="hljs-comment">-- int : Decoder Int</span>
 <span class="hljs-comment">-- field : String -&gt; Decoder a -&gt; Decoder a</span>
</code></pre>
<p>The <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#field" target="_blank"><code>field</code></a> function takes two arguments:</p>
<ol>
<li><code>String</code> &#x2014; a field name. So we are demanding an object with an <code>&quot;age&quot;</code> field.</li>
<li><code>Decoder a</code> &#x2014; a decoder to try next. So if the <code>&quot;age&quot;</code> field exists, we will try this decoder on the value there.</li>
</ol>
<p>So putting it together, <code>field &quot;age&quot; int</code> is asking for an <code>&quot;age&quot;</code> field, and if it exists, it runs the <code>Decoder Int</code> to try to extract an integer.</p>
<p>We do pretty much exactly the same thing to extract the <code>&quot;name&quot;</code> field:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, string)

<span class="hljs-title">nameDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">String</span>
<span class="hljs-title">nameDecoder</span> =
  field <span class="hljs-string">&quot;name&quot;</span> string

<span class="hljs-comment">-- string : Decoder String</span>
</code></pre>
<p>In this case we demand an object with a <code>&quot;name&quot;</code> field, and if it exists, we want the value there to be a <code>String</code>.</p>
<h2 id="nesting-decoders">Nesting Decoders</h2>
<p>Remember the <code>api.giphy.com</code> data?</p>
<pre><code class="lang-json">{
  <span class="hljs-string">&quot;data&quot;</span>: {
    <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;gif&quot;</span>,
    <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;l2JhxfHWMBWuDMIpi&quot;</span>,
    <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;cat love GIF by The Secret Life Of Pets&quot;</span>,
    <span class="hljs-string">&quot;image_url&quot;</span>: <span class="hljs-string">&quot;https://media1.giphy.com/media/l2JhxfHWMBWuDMIpi/giphy.gif&quot;</span>,
    <span class="hljs-string">&quot;caption&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,
    ...
  },
  <span class="hljs-string">&quot;meta&quot;</span>: {
    <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-number">200</span>,
    <span class="hljs-string">&quot;msg&quot;</span>: <span class="hljs-string">&quot;OK&quot;</span>,
    <span class="hljs-string">&quot;response_id&quot;</span>: <span class="hljs-string">&quot;5b105e44316d3571456c18b3&quot;</span>
  }
}
</code></pre>
<p>We wanted to access <code>response.data.image_url</code> to show a random GIF. Well, we have the tools now!</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, string)

<span class="hljs-title">gifDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">String</span>
<span class="hljs-title">gifDecoder</span> =
  field <span class="hljs-string">&quot;data&quot;</span> (field <span class="hljs-string">&quot;image_url&quot;</span> string)
</code></pre>
<p>This is the exact <code>gifDecoder</code> definition we used in our example program above! Is there a <code>&quot;data&quot;</code> field? Does that value have an <code>&quot;image_url&quot;</code> field? Is the value there a string? All our expectations are written out explicitly, allowing us to safely extract Elm values from JSON.</p>
<h2 id="combining-decoders">Combining Decoders</h2>
<p>That is all we needed for our HTTP example, but decoders can do more! For example, what if we want <em>two</em> fields? We snap decoders together with <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#map2" target="_blank"><code>map2</code></a>:</p>
<pre><code class="lang-elm"><span class="hljs-title">map2</span> : (a -&gt; b -&gt; value) -&gt; <span class="hljs-type">Decoder</span> a -&gt; <span class="hljs-type">Decoder</span> b -&gt; <span class="hljs-type">Decoder</span> value
</code></pre>
<p>This function takes in two decoders. It tries them both and combines their results. So now we can put together two different decoders:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, map2, field, string, int)

<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Person</span> =
  { name : <span class="hljs-type">String</span>
  , age : <span class="hljs-type">Int</span>
  }

<span class="hljs-title">personDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">Person</span>
<span class="hljs-title">personDecoder</span> =
  map2 <span class="hljs-type">Person</span>
      (field <span class="hljs-string">&quot;name&quot;</span> string)
      (field <span class="hljs-string">&quot;age&quot;</span> int)
</code></pre>
<p>So if we used <code>personDecoder</code> on <code>{ &quot;name&quot;: &quot;Tom&quot;, &quot;age&quot;: 42 }</code> we would get out an Elm value like <code>Person &quot;Tom&quot; 42</code>.</p>
<p>If we really wanted to get into the spirit of decoders, we would define <code>personDecoder</code> as <code>map2 Person nameDecoder ageDecoder</code> using our previous definitions. You always want to be building your decoders up from smaller building blocks!</p>
<h2 id="next-steps">Next Steps</h2>
<p>There are a bunch of important functions in <code>Json.Decode</code> that we did not cover here:</p>
<ul>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#bool" target="_blank"><code>bool</code></a> : <code>Decoder Bool</code></li>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#list" target="_blank"><code>list</code></a> : <code>Decoder a -&gt; Decoder (List a)</code></li>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#dict" target="_blank"><code>dict</code></a> : <code>Decoder a -&gt; Decoder (Dict String a)</code></li>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#oneOf" target="_blank"><code>oneOf</code></a> : <code>List (Decoder a) -&gt; Decoder a</code></li>
</ul>
<p>So there are ways to extract all sorts of data structures. The <code>oneOf</code> function is particularly helpful for messy JSON. (e.g. sometimes you get an <code>Int</code> and other times you get a <code>String</code> containing digits. So annoying!)</p>
<p>There are also <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#map3" target="_blank"><code>map3</code></a>, <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#map4" target="_blank"><code>map4</code></a>, and others for handling objects with more than two fields. But as you start working with larger JSON objects, it is worth checking out <a href="https://package.elm-lang.org/packages/NoRedInk/elm-json-decode-pipeline/latest" target="_blank"><code>NoRedInk/elm-json-decode-pipeline</code></a>. The types there are a bit fancier, but some folks find them much easier to read and work with.</p>
<blockquote>
<p><strong>Fun Fact:</strong> I have heard a bunch of stories of folks finding bugs in their <em>server</em> code as they switched from JS to Elm. The decoders people write end up working as a validation phase, catching weird stuff in JSON values. So when NoRedInk switched from React to Elm, it revealed a couple bugs in their Ruby code!</p>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="http.html" class="navigation navigation-prev " aria-label="Previous page: HTTP">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="random.html" class="navigation navigation-next " aria-label="Next page: Random">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"JSON","level":"1.8.2","depth":2,"next":{"title":"Random","level":"1.8.3","depth":2,"path":"effects/random.md","ref":"effects/random.md","articles":[]},"previous":{"title":"HTTP","level":"1.8.1","depth":2,"path":"effects/http.md","ref":"effects/http.md","articles":[]},"dir":"ltr"},"config":{"plugins":["youtube","bulk-redirect","ga","sitemap"],"root":"book","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"youtube":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"sitemap":{"hostname":"https://guide.elm-lang.jp/"},"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"ga":{"configuration":"auto","token":"UA-131798240-1"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Evan Czaplicki","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"An Introduction to Elm","language":"ja","gitbook":"*","description":"Learn the basics of Elm. Build applications. Learn functional programming."},"file":{"path":"effects/json.md","mtime":"2019-01-05T20:56:39.754Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-01-05T20:57:08.240Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

